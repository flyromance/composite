<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>

<body>

    <h1>递归</h1>
    <div><a href="https://segmentfault.com/a/1190000009857470">递归参考</a></div>
    <ul>
        <li>调用自身</li>
        <li>终止条件</li>
        <li>参数怎么传递</li>
    </ul>

    <div id='root'></div>
    <script>
        var trees = {
            tagname: 'div',
            props: {
                id: 'div',
                'data-target': 'div',
            },
            children: [
                {
                    tagname: 'p',
                    children: ['this is p.']
                },
                {
                    tagname: 'ul',
                    props: {
                        class: 'list',
                    },
                    children: [
                        {
                            tagname: 'li',
                            children: ['item1']
                        },
                        {
                            tagname: 'li',
                            props: {
                                classname: 'list-item'
                            },
                            children: ['item1']
                        }
                    ]
                }
            ]
        }

        function renderTree(node) {
            if (typeof node === 'object') {
                var el = document.createElement(node.tagname);
                for (var key in node.props) {
                    el.setAttribute(key, node.props[key]);
                }
                var children = node.children || [];
                children.forEach(function (child, index) {
                    el.appendChild(renderTree(child))
                })
            } else if (typeof node === 'string') {
                el = document.createTextNode(node);
            }
            return el;
        }

        document.getElementById('root').appendChild(renderTree(trees))

        function Element(tagname, props, children) {
            this.tagname = tagname || 'div';
            this.props = props || {};
            this.children = children || [];
        }

        Element.prototype.render = function () {
            var el = document.createElement(this.tagname);

            for (var key in this.props) {
                el.setAttribute(key, this.props[key]);
            }

            this.children.forEach(function (child, index) {
                var _child = null;
                if (child instanceof Element) {
                    _child = child.render()
                } else if (typeof child === 'object') {
                    _child = new Element(child.tagname, child.props, child.children).render()
                } else if (typeof child === 'string') {
                    _child = document.createTextNode(child);
                }
                _child && el.appendChild(_child)
            })

            return el;
        }

        function render(obj, id) {
            document.getElementById(id).appendChild(obj)
        }

        // render(new Element(trees.tagname, trees.props, trees.children).render(), 'root')
    </script>

    <script type="text/javascript">

        // 考察递归
        var data = {
            id: '1',
            name: 'node1',
            children: [
                {
                    id: '2',
                    name: 'node2'
                },
                {
                    id: '3',
                    name: 'node3',
                    children: [
                        {
                            id: '4',
                            name: 'node4'
                        }, {
                            id: '5',
                            name: 'node5'
                        }
                    ]
                },
            ],
        };

        function getNodeById(node, id) {
            if (node.id === id) return node;

            var children = node.children || [];
            var _node = null;
            children.forEach(function (child, index) {
                _node = getNodeById(child, id);
            });
            return _node;
        }

        console.log(getNodeById(data, '1'))
    </script>
</body>

</html>